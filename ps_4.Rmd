---
title: "Problem Set 4"
author: "Christopher Milne"
date: "2/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(ggplot2)
library(gt)
library(devtools)

data <- read.csv("ps_4_elections-poll-nc09-3.csv")
```
# Question 1
There were `r data %>% filter(response == "Dem") %>% summarize(n())` respondents who supported the Democratic candidate.

There were ```{r} data %>% 
  group_by(response) %>% 
  filter(response %in% c("Rep", "Und")) %>% 
  summarize(n())``` more respondents who favored the Republican candidate than who were Undecided.

There are two gender variables (gender and gender_combined). There are `r data %>% 
  filter(gender != gender_combined) %>% 
  summarize(n())` individuals for whom these variables have different values.

There are `r data %>% 
  filter(race_eth == "White", file_race_black != "White") %>% 
summarize(n())` respondents listed as “White” under race_eth who are not listed as “White” under file_race_black.

The first response of Rep came X minutes (rounded to the nearest minute) before the first response of Dem.



# Question 2
```{r, table, echo = FALSE, eval = FALSE}
x <-data %>% 
  select(response, race_eth, final_weight) %>% 
  group_by(response, race_eth) %>%
  summarize(total = sum(final_weight)) 

y <-x %>% 
  filter(race_eth != "[DO NOT READ] Don't know/Refused") %>% 
  spread(key = response, value = total) %>% 
  mutate(all = Dem + Rep + Und) %>% 
  mutate(DEM = Dem/all) %>% 
  mutate(REP = Rep/all) %>% 
  mutate(UND = Und/all) %>% 
  select(race_eth, DEM:UND)
y
gt(y) %>% 
  tab_header(
    title = "NC 9th Voter breakdown by Race and Party") %>% 
  
  cols_label(
    race_eth = "Race",
    DEM = "DEM.",
    REP = "REP.",
    UND = "UND."
  ) %>%
  
  fmt_percent(columns = vars(DEM, REP, UND),
              decimals = 0) %>% 
  as_raw_html() %>% as.character() %>% cat()
```

# Question 3
```{r, NC Graph, echo = FALSE}
x <- data %>% 
  select(response, educ, final_weight) %>% 
  group_by(educ) %>% 
  filter(educ != "[DO NOT READ] Refused")
x %>% 
  ggplot(aes(x = final_weight, y = educ))+geom_jitter()+geom_violin(scale = "area")+
  labs(title = "More Educated Matter Less in North Carolina 9th",
       subtitle = "Poll gives more weight to people who are less likely to participate in polls",
       x= "Weight Given to Respondent in Calculating Poll Results",
       y = NULL,
       source = "New York Times Upshot/Siena College 2018 live polls")
```

# Question 4
